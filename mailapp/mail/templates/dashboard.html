<h3>Dashboard</h3><br>
<a href="{% url 'send_mail' %}">Send Mail</a> |
<a href="{% url 'smtp_settings' %}">SMTP Settings</a> |
<a href="{% url 'logout' %}">Logout</a>
<hr>

<h3>Sent Mails</h3>


<!-- Bootstrap 5 Accordion for collapsible mail cards -->
<div class="accordion" id="sentMailAccordion">
  {% for email in emails %}
    <div class="accordion-item mb-2 shadow-sm">
      <h2 class="accordion-header" id="heading{{ forloop.counter }}">
        <button class="accordion-button collapsed" type="button"
                data-bs-toggle="collapse"
                data-bs-target="#collapse{{ forloop.counter }}"
                aria-expanded="false"
                aria-controls="collapse{{ forloop.counter }}">
                
          {{ email.to_email }} â€” {{ email.subject }} ({{ email.sent_at|date:"d M, Y H:i" }})            
        </button>
      </h2>
      <div id="collapse{{ forloop.counter }}"
           class="accordion-collapse collapse"
           aria-labelledby="heading{{ forloop.counter }}"
           data-bs-parent="#sentMailAccordion">
        <div class="accordion-body">
          <p><strong>To:</strong> {{ email.to_email }}</p>
          <p><strong>Subject:</strong> {{ email.subject }}</p>
          <p><strong>Message:</strong><br>
             {{ email.message|linebreaksbr }}
          </p>
          <p class="text-muted small">Sent At: {{ email.sent_at|date:"F d, Y, h:i a" }}</p>

          <!-- <div class="accordion-body"> -->
            <!-- <p><strong>To:</strong> {{ email.to_email }}</p>
            <p><strong>Subject:</strong> {{ email.subject }}</p>
            <p><strong>Message:</strong><br>
              {{ email.message|linebreaksbr }}
            </p> -->
            <!-- <p class="text-muted small">Sent At: {{ email.sent_at|date:"F d, Y, h:i a" }}</p> -->

            <!-- Delete Button -->
            
          <!-- </div> -->

          <form method="post" action="{% url 'delete_mail' email.id %}" style="display:inline;">
              {% csrf_token %}
              <button class="btn btn-sm btn-danger mt-2" onclick="return confirm('Are you sure you want to delete this mail?');" type="submit">
                Delete
              </button>
          </form>

        </div>
      </div>
    </div>


    
  {% empty %}
    <div class="alert alert-info">No emails sent yet.</div>
  {% endfor %}
</div>




<!-- Bootstrap CSS + JS links (add if not included in your base.html) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
